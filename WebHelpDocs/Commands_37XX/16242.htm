<table class="relatedtopics aboveheading" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "18">
<p class="bodytext"><a href="16633.htm" target="_self"><img id="f125" src="4200a_lc_previous_button.png" class="linkedpngtemplate4200a-nocaption" alt="Previous Icon" height="23" width="74" vspace="0" hspace="0" align="bottom" border="0"></a></p></td>
<td width= "18">
<p class="bodytext"><a href="16891.htm" target="_self"><img id="f124" src="4200a_lc_next_button.png" class="linkedpngtemplate4200a-nocaption" alt="Next Icon" height="23" width="74" vspace="0" hspace="0" align="bottom" border="0"></a></p></td>
</tr>
</table>

<h2 id="t16242" class="heading2-icl">scan.addwrite()</h2>
<p class="bodyzero">This function writes a specified value to a channel at the added step in the scan.</p>
<table class="tableintopic" width="672" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #D3D3D3">
<tr align="left" valign="top">
<th bgcolor="#191970" style="border:1px solid #D3D3D3;" width="86"><p class="tableheadingwhitetext">Type</p>
</th>
<th bgcolor="#191970" style="border:1px solid #D3D3D3;" width="120"><p class="tableheadingwhitetext">TSP-Link accessible</p>
</th>
<th bgcolor="#E4E4E4" style="border:1px solid #D3D3D3;" width="144"><p class="tableheading"><span class="grayedout">Affected by</span></p>
</th>
<th bgcolor="#E4E4E4" style="border:1px solid #D3D3D3;" width="144"><p class="tableheading"><span class="grayedout">Where saved</span></p>
</th>
<th bgcolor="#E4E4E4" style="border:1px solid #D3D3D3;" width="178"><p class="tableheading"><span class="grayedout">Default value</span></p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #D3D3D3;" width="86"><p class="tablebodytextsmall">Function</p>
</td>
<td style="border:1px solid #D3D3D3;" width="120"><p class="tablebodytextsmall">Yes</p>
</td>
<td style="border:1px solid #D3D3D3;" width="144"><p class="tablebodytextsmall">&nbsp;</p>
</td>
<td style="border:1px solid #D3D3D3;" width="144"><p class="tablebodytextsmall">&nbsp;</p>
</td>
<td style="border:1px solid #D3D3D3;" width="178"><p class="tablebodytextsmall">&nbsp;</p>
</td>
</tr>

</table>
<p class="iclsubheading">Usage</p>
<p class="iclcode">scan.addwrite(&quot;<span class="monospaceitalic">channelList</span>&quot;, <em class="emphasis">writeValue</em>)</p>
<p class="iclcode">scan.addwrite(&quot;<span class="monospaceitalic">channelList</span>&quot;, <em class="emphasis">writeValue</em>, <em class="emphasis">width</em>)</p>
<p class="iclspacing"></p>
<table class="tableintopic" width="600" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse">
<tr>
<td width="139" height="0"></td>
<td width="0" height="0"></td>
<td width="460" height="0"></td>
<td width="0" height="0"></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #C0C0C0;" colspan="2" width="139"><p class="tablebodytext"><span class="monospaceitalic">channelList</span></p>
</td>
<td style="border:1px solid #C0C0C0;" colspan="2" width="461"><p class="tablebodytext">String specifying channels to add using normal channel list syntax</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #C0C0C0;" colspan="2" width="139"><p class="tablebodytext"><span class="monospaceitalic">writeValue</span></p>
</td>
<td style="border:1px solid #C0C0C0;" colspan="2" width="461"><p class="tablebodytext">The value to write to the channel for this scan step</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #C0C0C0;" width="139"><p class="tablebodytext"><span class="monospaceitalic">width</span></p>
</td>
<td style="border:1px solid #C0C0C0;" colspan="2" width="461"><p class="tablebodytext">Specifies the width of the channel write to use with items in <span class="monospaceitalic">channelList</span></p>
</td>
</tr>

</table>
<p class="iclspacing"> </p>
<p class="iclsubheading">Details</p>
<p class="iclbody">This command is similar to issuing <code class="monospace">channel.write()</code> at the scan step. Specifying multiple channels in <span class="monospaceitalic">channelList </span>causes multiple steps to be added to the scan. </p>
<p class="iclbody">For digital I/O channels, only a width of 1, 2, 3, or 4 is supported. Any information (bits) greater than the specified width are ignored. Values written to inputs are ignored. If no specified channel is set for output, an error is generated. If a width crosses channels, only the channels set to output are affected.</p>
<p class="iclbody">This is not available for backplane and switch channels.</p>
<p class="iclbody">For DAC channels, if the channel mode is changed after the scan is created, the scan is rebuilt. If the write value is no longer compatible with the new mode, an error is generated and the scan becomes invalid.</p>
<p class="iclsubheading">Example</p>
<p class="iclspacing"></p>
<p class="iclspacing"></p>
<table class="tableintopic" width="662" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #C0C0C0">
<tr align="left" valign="top">
<td bgcolor="#E0E0E0" style="border:1px solid #C0C0C0;" width="350"><p class="codetable">scan.addwrite(&quot;6001, 6003, 6005&quot;, 21845, 2)</p>
</td>
<td style="border:1px solid #C0C0C0;" width="312"><p class="tablebodytext">Assume a 3750 in slot 6. Add to existing scan list channels 1, 3 and 5 on slot 6 to write a 16-bit hex value of hexadecimal 5555 (decimal 21845).</p>
</td>
</tr>

</table>
<p class="iclsubheading">Also see</p>
<p class="listcommand">Scanning and triggering</p>


