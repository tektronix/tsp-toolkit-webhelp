<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title> script.load() </title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" /> 
<script type="text/javascript">
        function isTOCLoaded() {
            //this function for loading the topic within the application if loaded by itself
            //i.e. open the topic .htm file or as search engines link
            var url = window.location.href;
            var baseUrl = url.substring(0, url.lastIndexOf("/") + 1);
            var topicFile = url.substring(url.lastIndexOf("/") + 1)
            var newUrl = baseUrl + "index.htm#" + topicFile;
            location.href = newUrl;
            return false;
        }
</script>
</head>
<body>
<table class="relatedtopics aboveheading" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "18">
<p class="bodytext"><a href="19931.htm" target="_self"><img id="f125" src="4200a_lc_previous_button.png" class="linkedpngtemplate4200a-nocaption" alt="Previous Icon" height="23" width="74" vspace="0" hspace="0" align="bottom" border="0"></a></p></td>
<td width= "18">
<p class="bodytext"><a href="15064.htm" target="_self"><img id="f124" src="4200a_lc_next_button.png" class="linkedpngtemplate4200a-nocaption" alt="Next Icon" height="23" width="74" vspace="0" hspace="0" align="bottom" border="0"></a></p></td>
</tr>
</table>
<h2 id="t15063" class="heading2-icl">script.load()</h2>
<p class="bodyzero">This function creates a script from a specified file.</p>
<table class="tableintopic" width="672" cellpadding="2" cellspacing="0" border="2" style="border-collapse:collapse; border:2px solid #D3D3D3">
<tr align="left" valign="top">
<th bgcolor="#4A6B95" style="border:2px solid #D3D3D3;" width="86"><p class="tableheadingwhitetext">Type</p>
</th>
<th bgcolor="#4A6B95" style="border:2px solid #D3D3D3;" width="130"><p class="tableheadingwhitetext">TSP-Link accessible</p>
</th>
<th bgcolor="#E4E4E4" style="border:2px solid #D3D3D3;" width="134"><p class="tableheading"><span class="grayedout">Affected by</span></p>
</th>
<th bgcolor="#E4E4E4" style="border:2px solid #D3D3D3;" width="144"><p class="tableheading"><span class="grayedout">Where saved</span></p>
</th>
<th bgcolor="#E4E4E4" style="border:2px solid #D3D3D3;" width="178"><p class="tableheading"><span class="grayedout">Default value</span></p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:2px solid #D3D3D3;" width="86"><p class="tablebodytextsmall">Function</p>
</td>
<td style="border:2px solid #D3D3D3;" width="130"><p class="tablebodytextsmall">No</p>
</td>
<td style="border:2px solid #D3D3D3;" width="134"><p class="tablebodytextsmall">&nbsp;</p>
</td>
<td style="border:2px solid #D3D3D3;" width="144"><p class="tablebodytextsmall">&nbsp;</p>
</td>
<td style="border:2px solid #D3D3D3;" width="178"><p class="tablebodytextsmall">&nbsp;</p>
</td>
</tr>

</table>
<p class="iclsubheading">Usage</p>
<p class="iclcode"><span class="monospaceitalic">scriptVar</span> = script.load(&quot;<span class="monospaceitalic">file</span>&quot;)</p>
<p class="iclcode"><span class="monospaceitalic">scriptVar</span> = script.load(&quot;<span class="monospaceitalic">file</span>&quot;, &quot;<span class="monospaceitalic">name</span>&quot;)</p>
<p class="iclspacing"></p>
<table class="tableintopic" width="600" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #E0E0E0">
<tr align="left" valign="top">
<td style="border:1px solid #E0E0E0;" width="139"><p class="codetable"><span class="monospaceitalic">scriptVar</span></p>
</td>
<td style="border:1px solid #E0E0E0;" width="461"><p class="tablebodytext">The created script; this is <code class="monospace">nil</code> if an error is encountered</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #E0E0E0;" width="139"><p class="codetable"><span class="monospaceitalic">file</span></p>
</td>
<td style="border:1px solid #E0E0E0;" width="461"><p class="tablebodytext">The path and file name of the script file to load</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #E0E0E0;" width="139"><p class="codetable"><span class="monospaceitalic">name</span></p>
</td>
<td style="border:1px solid #E0E0E0;" width="461"><p class="tablebodytext">The name of the script to be created</p>
</td>
</tr>

</table>
<p class="iclsubheading">Details</p>
<p class="iclbody">The file path may be absolute or relative to the current working directory. The root folder of the USB flash drive has the absolute path <code class="monospace">&quot;/usb1/&quot;</code>. Both the forward slash (/) and backslash (\) are supported as directory separators.</p>
<p class="iclbody">The file to be loaded must start with the <code class="monospace">loadscript</code> or <code class="monospace">loadandrunscript</code> keywords, contain the body of the script, and end with the <code class="monospace">endscript</code> keyword.</p>
<p class="iclbody">Script naming:</p>
<ul class="listbullet"><li class="listbullet">If the <span class="monospaceitalic">name</span> parameter is an empty string, or <span class="monospaceitalic">name</span> is absent (or <code class="monospace">nil</code>) and the script name cannot be extracted from the file, <span class="monospaceitalic">scriptVar</span> is the only handle to the created script.</li><li class="listbullet">If <span class="monospaceitalic">name</span> is given (and not <code class="monospace">nil</code>), any script name embedded in the file is ignored.</li><li class="listbullet">If <span class="monospaceitalic">name</span> conflicts with the name of an existing script in the <code class="monospace">script.user.scripts</code> table, the existing script&#8217;s name attribute is set to an empty string before it is replaced in the <code class="monospace">script.user.scripts</code> table by the new script.</li><li class="listbullet">If <span class="monospaceitalic">name</span> is absent or <code class="monospace">nil</code>, the command attempts to extract the name of the script from the file. Any conflict between the extracted name and that of an existing script in the scripts table generates an error. If the script name cannot be extracted, the created script's name attribute is initialized to the empty string and must be set to a valid nonempty string before saving the script to nonvolatile memory.</li></ul><p class="iclsubheading">Example</p>
<p class="iclspacing"></p>
<table class="tableintopic" width="600" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #E0E0E0">
<tr align="left" valign="top">
<td bgcolor="#E0E0E0" style="border:1px solid #E0E0E0;" width="350"><p class="codetable">myTest8 = <br>   script.load(&quot;/usb1/filename.tsp&quot;, &quot;myTest8&quot;)</p>
</td>
<td style="border:1px solid #E0E0E0;" width="250"><p class="tablebodytext">Loads the script <code class="monospace">myTest8</code> from the USB flash drive.</p>
</td>
</tr>

</table>
<p class="iclsubheading">Also see</p>
<p class="listcommand"><a id="h15066" class="jump" title="script.new()" href="15064.htm" target="_self">script.new()</a></p>


<input id="topicId" type="hidden" value="15063" />
<input id="topicDescription" type="hidden" value="script.load()" />
<input id="footer-modified" type="hidden" value="Last modified: 4/3/2020 9:45:40 AM" />
</body>
</html>
